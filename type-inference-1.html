<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Type Inference 001</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="/posts.css">
  <link rel="stylesheet" href="/charlesetc.github.io.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">Type Inference 001</h1>
</header>
<p>A couple weeks ago I was at the <a href="https://www.recurse.com/">Recurse Center</a> and attempted to give a talk about type inference. I didn't have enough time to flesh out all of the details I would have liked, so this series of blog posts aims to do it better: provide an in-depth and beginner-level introduction to type inference.</p>
<p>This post in particular will provide some examples of human-driven type inference to give an intuitive notion of what the rest of the posts will be covering. (i.e. how to people reason and think about types?)</p>
<h1 id="what-is-a-type">What is a type?</h1>
<p>In the most basic sense, a type is a formalized way of thinking <em>about</em> code. Different languages formalize types in different ways, and incorporate them to greater or lesser extents.</p>
<h3 id="c-language">C language</h3>
<p>In C, a type is assigned to each part of the source code. And the compiler makes sure you are consistent.</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">int</span> main(<span class="dt">void</span>) {
  <span class="dt">char</span> *name = <span class="st">&quot;Julia&quot;</span>;

  <span class="co">// Compiler error! `main` should return an int.</span>
  <span class="kw">return</span> name;
}</code></pre></div>
<p><strong>However</strong>, C lets you bypass this completely, with what is called a &quot;cast&quot;.</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">int</span> main(<span class="dt">void</span>) {
  <span class="dt">char</span> *name = <span class="st">&quot;Julia&quot;</span>;
  <span class="kw">return</span> (<span class="dt">int</span>)name;
}</code></pre></div>
<p>This compiles perfectly well and exits with the code <code>116</code> for me. (It might be undefined behaviour?) So C's type system is a little more lenient than many others.</p>
<p>A fun fact is that some old C compilers didn't do type checking. Since the types are a thin layer on top of the language, it's not strictly necessary.</p>
<p>This wouldn't work for other languages, though. In Rust, for example, the action from a given piece of code depends on its types.</p>
<h3 id="rust-language">Rust language</h3>
<div class="sourceCode"><pre class="sourceCode rust"><code class="sourceCode rust"><span class="kw">struct</span> Pineapple;
<span class="kw">struct</span> Mango;

<span class="co">// A trait defines methods that can</span>
<span class="co">// change based on  the type.</span>
<span class="kw">trait</span> Peelable {
  <span class="kw">fn</span> peel(<span class="kw">self</span>);
}

<span class="kw">impl</span> Peelable <span class="kw">for</span> Pineapple {
  <span class="kw">fn</span> peel(<span class="kw">self</span>) {
    <span class="co">// Code for Pineapple</span>
  }
}

<span class="kw">impl</span> Peelable <span class="kw">for</span> Mango {
  <span class="kw">fn</span> peel(<span class="kw">self</span>) {
    <span class="co">// Code for Mango</span>
  }
}

<span class="co">// This function calls different</span>
<span class="co">// code depending on the specific</span>
<span class="co">// type of it&#39;s argument!</span>
<span class="kw">fn</span> prepare(fruit: Peelable) {
  fruit.peel();
  fruit.eat();
  oops();
}</code></pre></div>
<p>What we see here is something that can't happen in C: the implementation of <code>peel</code> changes depending on the <strong>type</strong> <code>prepare</code> is called with.</p>
<p>Our concept of <strong>type</strong> has been elevated to actually affect the program that executes, above a simple checking pass like in C.</p>
<p>The beauty of traits in Rust is that, by default, there is no 'if' check done at run-time. Rust knows ahead of time which parameter is being passed into the function and inserts a direct function call into.</p>
<h1 id = 'title' class='title'><a href="/"><span class='wrapper'>
<span>C</span><span>h</span><span>a</span><span>r</span><span>l</span><span>e</span><span>s</span><span>, </span><span>e</span><span>t</span><span>c</span>
  </span></a></h1>


<!-- Google analytics software -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69527650-1', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>
